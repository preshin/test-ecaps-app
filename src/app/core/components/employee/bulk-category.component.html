<div nz-row>
  <div nz-col nzSm="12" nzMd="12" nzLg="12" nzXl="12">
    <a
      class="back-button-text"
      [routerLink]="['/', 'employee', 'list', 'add-type-selection']"
      ><img
        class="back-img"
        src="assets/images/back-button.svg"
      />&nbsp;&nbsp;BACK</a
    >
    <br />
    <br />
    <h3 class="primary-color-font">Bulk Upload</h3>
    <p>Add Employees by uploading excel</p>
  </div>
  <div nz-col nzSm="12" nzMd="12" nzLg="12" nzXl="12">
    <a nz-button nzType="info" href="assets/bulk/Bulk-Add-Employee-Sample.csv"
      >Download Sample Excel</a
    >
  </div>
</div>
<br />
<!-- <div nz-row nzType="flex">
  <nz-upload
    nzType="drag"
    [nzMultiple]="true"
    [nzLimit]="2"
    nzAction="https://jsonplaceholder.typicode.com/posts/"
    (nzChange)="handleChange($event)"
  >
    <p class="ant-upload-drag-icon">
      <i nz-icon nzType="cloud-upload" nzTheme="outline"></i>
    </p>
    <p class="ant-upload-text">
      Drag and drop excel here or <b>Browse</b> for files.
    </p>
  </nz-upload>
</div> -->

<input type="file" accept=".csv" (change)="onFileChange($event)" />

<div id="output"></div>
<br />
<!-- <div *ngIf="willDownload">
  <a id="download">
    Download JSON File
  </a>
</div> -->

<br />
<div nz-row>
  <div nz-col nzSm="12" nzMd="12" nzLg="12" nzXl="12">
    <div nz-row>
      <div nz-col nzSm="8" nzMd="8" nzLg="8" nzXl="8">
        <button
          [disabled]="jsonData == null"
          nz-button
          nzType="primary"
          (click)="importData()"
        >
          Import
        </button>
      </div>
      <div nz-col nzSm="8" nzMd="8" nzLg="8" nzXl="8"></div>
      <div nz-col nzSm="8" nzMd="8" nzLg="8" nzXl="8">
        <!-- <button nz-button nzType="primary" (click)="importData()">
          Import
        </button> -->
      </div>
    </div>
  </div>
</div>

<br />

<div
  *ngIf="success.length > 0"
  class="ant-alert ng-trigger ng-trigger-slideAlertMotion ng-tns-c14-15 ant-alert-success ant-alert-with-description ng-star-inserted"
>
  <!----><!----><!----><i
    class="anticon ant-alert-icon ng-tns-c14-15 anticon-close-circle ng-star-inserted"
    nz-icon=""
    style=""
    ><svg
      viewBox="64 64 896 896"
      fill="currentColor"
      width="1em"
      height="1em"
      class="ng-tns-c14-12"
      data-icon="check-circle"
      aria-hidden="true"
    >
      <path
        d="M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"
      ></path>
      <path
        d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"
      ></path></svg></i
  ><!----><!----><span
    class="ant-alert-message ng-tns-c14-15 ng-star-inserted"
    style=""
    ><!----><!---->Success</span
  ><!----><span
    class="ant-alert-description ng-tns-c14-15 ng-star-inserted"
    style=""
    ><!----><!---->

    We have successfully sent emails to the following
    {{ success.length }} employees to complete their Enviar signup process.
    <br />
    <br />
    <span *ngFor="let item of success"> {{ item.email }},&nbsp; </span> </span
  ><!---->
</div>

<br />
<div
  *ngIf="error.length > 0"
  class="ant-alert ng-trigger ng-trigger-slideAlertMotion ng-tns-c14-15 ant-alert-error ant-alert-with-description ng-star-inserted"
>
  <!----><!----><!----><i
    class="anticon ant-alert-icon ng-tns-c14-15 anticon-close-circle ng-star-inserted"
    nz-icon=""
    style=""
    ><svg
      viewBox="64 64 896 896"
      fill="currentColor"
      width="1em"
      height="1em"
      class="ng-tns-c14-15"
      data-icon="close-circle"
      aria-hidden="true"
    >
      <path
        d="M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4-66.1-.3c-4.4 0-8 3.5-8 8 0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 00-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4 66 .3c4.4 0 8-3.5 8-8 0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z"
      ></path>
      <path
        d="M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448 448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"
      ></path></svg></i
  ><!----><!----><span
    class="ant-alert-message ng-tns-c14-15 ng-star-inserted"
    style=""
    ><!----><!---->Error</span
  ><!----><span
    class="ant-alert-description ng-tns-c14-15 ng-star-inserted"
    style=""
    ><!----><!---->
    We could not send emails to the following {{ error.length }} employees as
    either the mobile number or email address entered has already been
    registered on Enviar:
    <br />
    <br />
    <div *ngFor="let item of error">
      {{ item.email }}, Details - {{ parseError(item.details) }}
    </div> </span
  ><!---->
</div>
